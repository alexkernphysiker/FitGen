cmake_minimum_required(VERSION 2.6)
project(FitGen)

add_subdirectory(math_h)
set(CMAKE_CXX_FLAGS -pthread)
add_definitions(-std=c++11 -Wall -Wunused-parameter)
include_directories(include)
file(GLOB SOURCES src/*.cpp)
file(GLOB TESTS tests/*.cpp)
file(GLOB EXAMPLES Example/*.cpp)
add_library(FitGen SHARED ${SOURCES})
target_link_libraries(FitGen gpwrap)

foreach(example ${EXAMPLES})
	get_filename_component(ex_app ${example} NAME_WE)
	add_executable(${ex_app} ${example})
	target_link_libraries(${ex_app} FitGen)
endforeach()

option(tests "Build all tests." OFF) 
if(tests)
	find_package(GTest REQUIRED)
	include_directories(${GTEST_INCLUDE_DIRS})
	set(CMAKE_CXX_FLAGS "-fprofile-arcs -ftest-coverage -g -Wall -pthread -std=gnu++11")
	add_executable(fitgen_test.exe ${TESTS})
	target_link_libraries(fitgen_test.exe FitGen ${GTEST_BOTH_LIBRARIES})
endif()
